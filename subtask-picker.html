<!DOCTYPE html>
<html>
  <head>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
  </head>
  <body style="margin: 10px;">
    <input type="url" id="subtask-url" placeholder="Paste Trello card URL" style="width:100%; margin-bottom:8px;" />
    <button onclick="saveSubtask()" style="width:100%;">Save Subtask</button>

    <script>
      const t = TrelloPowerUp.iframe();

      function saveSubtask () {
        const url = document.getElementById('subtask-url').value.trim();
        if (!url) return;

        t.get('card', 'shared', 'subtasks', [])
          .then(subtasks => {
            subtasks.push(url);
            return t.set('card', 'shared', 'subtasks', subtasks);
          })
          .then(() => t.closePopup());
      }
    </script>
  </body>
</html>
